generator client {
  provider   = "prisma-client"
  output     = "../generated/prisma"
  engineType = "client"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER
  ADMIN
}
enum MembershipTier {
  PREMIUM
}

enum MealTime {
  BREAKFAST
  LUNCH
  DINNER
  SNACK
}

model User {
  id            Int            @id @default(autoincrement())
  email         String         @unique
  name          String
  password      String
  role          Role?          @default(USER)
  meals         Meal[]
  refreshToken  String?
  nutritionGoal NutritionGoal?
  membership    Membership?    
  hasOnboarded  Boolean        @default(false)
}

model Meal {
  id        Int        @id @default(autoincrement())
  userId    Int
  user      User       @relation(fields: [userId], references: [id])
  name      String 
  items     MealItem[]
  eatenAt   DateTime   @default(now())
  createdAt DateTime   @default(now())
}

model MealItem {
    id                   Int     @id     @default(autoincrement())               
    mealId               Int                                                                
    meal                 Meal    @relation(fields:  [mealId], references:  [id])
    food_name            String                                                             
    estimated_portion_g  Int     @default(0)                                                
    calories_kcal        Int     @default(0)                                                
    protein_g            Int     @default(0)                                                
    fat_g                Int     @default(0)                                                
    carbohydrates_g      Int     @default(0)                                                
    fiber_g              Int?    @default(0)                                                
    sugar_g              Int?    @default(0)                                                
    sodium_mg            Int?    @default(0)                                                
}

model NutritionGoal {
    id               Int   @id                @default(autoincrement())               
    userId           Int   @unique                                                    
    user             User  @relation(fields:  [userId],                  references:  [id])
    calories_kcal    Int   @default(0)                                                
    protein_g        Int?  @default(0)                                                
    carbohydrates_g  Int?  @default(0)                                                
    fat_g            Int?  @default(0)                                                
}

model Membership {
    id          Int   @id @default(autoincrement()) 
    userId      Int   @unique
    user        User  @relation(fields: [userId], references: [id])
    tier        MembershipTier
    createdAt   DateTime    @default(now())
    expiresAt   DateTime
}



